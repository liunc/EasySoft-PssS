@using EasySoft.PssS.Web.Resources;

@{
    ViewBag.Title =  WebResource.UserLogin_Title;
}

<div class="cart-panel">
    <form id="loginForm" class="am-form">
        <div class="am-form-group am-form-icon">
            <i class="am-icon-user" style="color:#329cd9"></i>
            <input id="txtMoblie" type="text" class="am-form-field  my-radius" placeholder="@WebResource.UserLogin_Moblie" required="true">
        </div>
        <div class="am-form-group am-form-icon">
            <i class="am-icon-lock" style="color:#329cd9"></i>
            <input id="txtPassword" type="password" class="am-form-field  my-radius" placeholder="@WebResource.UserLogin_Password" required="true">
        </div>
        @*<div class="am-checkbox">
                <label>
                    <input  type="checkbox"> 记住密码
                </label>
            </div>*@
        <p class="am-text-center"><button id="btnLogin" type="submit" class="am-btn am-btn-danger am-radius am-btn-block">@WebResource.UserLogin_LoginButton</button></p>
        <div style="height:45px;">
            <div id="errorMessage">

            </div>
        </div>
    </form>
</div>
@section JsScripts {
    <script>
        $(function () {
            $("#btnLogin").click(function () {
                var moblie = $.trim($("#txtMoblie").val());
                var password = $.trim($("#txtPassword").val());
                if (moblie.length == 0) {
                    showError("@WebResource.UserLogin_MoblieTip");
                    return false;
                }
                if (password.length == 0) {
                    showError("@WebResource.UserLogin_PasswordTip");
                    return false;
                }
                var model = {};
                model.Moblie = moblie;
                model.Password = password;
                model.ReturnUrl = "@ViewBag.ReturnUrl";
                $.ajax({
                    type: 'post',
                    url: '/User/Login',
                    data: { model: model },
                    success: function (result) {
                        if (result.Result) {
                            window.location.href = result.Data;
                        }
                        else {
                            showError(result.Message);
                        }
                        return false;
                    }
                });
                return false;
            });
        });
        function showError(errorMessage) {
            $("#errorMessage").html(errorMessage);
            $("#errorMessage").show(100);
            setTimeout(function () { $("#errorMessage").hide(800); }, 1500);
        }
    </script>
}


